package base::event::sample;
#  W5Base Framework
#  Copyright (C) 2006  Hartmut Vogler (it@guru.de)
#
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.
#
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#
#  You should have received a copy of the GNU General Public License
#  along with this program; if not, write to the Free Software
#  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
#
use strict;
use vars qw(@ISA);
use kernel;
use kernel::Event;
@ISA=qw(kernel::Event);

sub new
{
   my $type=shift;
   my %param=@_;
   my $self=bless($type->SUPER::new(%param),$type);

   return($self);
}

sub Init
{
   my $self=shift;


   $self->RegisterEvent("wiwTest","wiwTest");
   $self->RegisterEvent("modWf","modWf");
   $self->RegisterEvent("wftest","wftest");
   $self->RegisterEvent("memtest","memtest");
   $self->RegisterEvent("filecheck","filecheck");
   $self->RegisterEvent("test","test");
   $self->RegisterEvent("sample","SampleEvent1");
   $self->RegisterEvent("sample1","SampleEvent1",timeout=>180);
   $self->RegisterEvent("timeoutcheck","TimeOutError",timeout=>5);
   $self->RegisterEvent("sample2","SampleEvent2");
   $self->RegisterEvent("sample3","SampleEvent3");
   $self->RegisterEvent("MyTime","SampleEvent2");
   $self->RegisterEvent("long","base::event::sample::SampleEvent1");
   $self->RegisterEvent("long","SampleEvent3");
   $self->RegisterEvent("LongRunner","LongRunner");
   $self->RegisterEvent("loadsys","loadsys");
   $self->RegisterEvent("testmail1","TestMail1");
   $self->RegisterEvent("testmail2","TestMail2");
   $self->CreateIntervalEvent("MyTime",10);
   return(1);
}

sub LongRunner
{
   my $self=shift;

   for(my $c=0;$c<20;$c++){
      msg(DEBUG,"LonRunner Loop $c");
      last if ($self->ServerGoesDown());
      sleep(1);
   }
   return({exitcode=>0,msg=>'ok'});
}

sub test
{
   my $self=shift;
   return({exitcode=>0,msg=>'ok',
           res=>
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'.
           '123456789012345678901234567890123456789012345678901234567890'
          });
}

sub filecheck
{
   my $self=shift;
   if (-f "/tmp/file"){
      return({exitcode=>0,msg=>'ok'});
   }
   return({exitcode=>1,msg=>'file not found'});
   
}

sub TimeOutError
{
   my $self=shift;

   sleep(10);
   return({exitcode=>0,msg=>'ok'});
}

sub TestMail1
{
   my $self=shift;

   my $wf=getModuleObject($self->Config,"base::workflow");
   my $r=$wf->Store(12295216960002,{mandator=>['AL T-Com','xx',mandatorid=>44]});
   return({msg=>'shit'});
}

sub TestMail2
{
   my $self=shift;

   my $wf=getModuleObject($self->Config,"base::workflow");
   if (my $id=$wf->Store(undef,{
          class    =>'base::workflow::mailsend',
          step     =>'base::workflow::mailsend::dataload',
          name     =>'eine Mail vom Testevent1 mit äöüß',
          emailto  =>'vogler.hartmut@xxxxxxxxxxxxxm',
          emailfrom=>'"Vogler, Hartmut" <>',
          emailtext=>["Dies ist der\n 1. Text",'dies der 2.','und der d 100 Zeichen: 12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890ritte'],
          emailhead=>['Head1','Head2 mal ein gaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaanz langer Text1234567345624354357246357832','Head3'],
          emailtstamp=>['01.01.2000 14:14:00',undef,'02.02.2000 01:01:01'],
          emailprefix=>['sued/xxxxxx.hartmut',undef,'nobody'],
         })){
      my $r=$wf->Store($id,step=>'base::workflow::mailsend::waitforspool');
      return({msg=>'versandt'});
   }
   return({msg=>'shit'});
}

sub modWf
{
   my $self=shift;
   my $p=$self;

   my $wf=getModuleObject($self->Config,"base::workflow");
   my $op=$wf->Clone();

   $wf->SetFilter({class=>\'AL_TCom::workflow::businesreq',
                   id=>[qw(




13190273750015 13233446870001 13233503640001 13243057570001 13319049610001 13188522020001 13216200640002 13262823020005 13268799620014 13275799860001 13279209700001 13281751210001 13285320620000 13293235230011 13294896020000 13298150430011 13298301620001 13303401620003 13305867670001 13305876020001 13311123030003 13321642220018 13322447430014 13327641640017 13328589640007 13334427640003 13353389440001 13354156840001 13363744840007 13369952460005 13369981860001 13391461670014 13394148660001 13400100660003 13400154650003 13400830510001 13400833890001 13400834540001 13401933090001 13402687900021 13403572890001 13407796260017 13413894670001 13419141740003 13419892270001 13421670610001 13425122410001 13425978060007 13432202410003 13436480470001 13438296650014 13148691680001 13158332450001 13158336020001 13160956830001 13160960410013 13160960430007 13160960440017 13160960460009 13160964010002 13160967610005 13161644420001 13164358860004 13164362420001 13164362440001 13164362460001 13164366040007 13164366060001 13164366070016 13164366090002 13164366100013 13164366120003 13164369620001 13164369630011 13164369650003 13164369660013 13164369680001 13165147230001 13165147290001 13165154410001 13165158020001 13165165220001 13165168820001 13165168830011 13165204820001 13165284030001 13165287640003 13165921220001 13165921260001 13166810420001 13166814020001 13170352920001 13170352940005 13172102420001 13172102440007 13172138420001 13172934020001 13172937620001 13173722430001 13173729720004 13173733240001 13178128870015 13178128890001 13178136050001 13178143240001 13178146850001 13178150460001 13178154050001 13178154080001 13178157700001 13178161250001 13178161260013 13179032440007 13179903860001 13182537010006 13183346120001 13183354780001 13184329810001 13184333420001 13184972410001 13184972470001 13185825610001 13185825640001 13185876010001 13188385210003 13188558010001 13188579610001 13189350020001 13189350040001 13189357210001 13190295030007 13191058220001 13191066620001 13191070890001 13197144020012 13197144280001 13197152430003 13197152800007 13197207740005 13197345620001 13197354020001 13197354330003 13197354930001 13197358230001 13203308440002 13204037430001 13204038160001 13204038830005 13204039510001 13204048230007 13204049210007 13204058430003 13204059140003 13204059860001 13204067380001 13204071060001 13207393990001 13207401050001 13207432200001 13209205010001 13209209130001 13209209540001 13209210240001 13209213030001 13209213410001 13218721690001 13218722100003 13218725440001 13218733950001 13221405640001 13221409860001 13221410290001 13221411240007 13221411710001 13221414030013 13221414990009 13221418270003 13221419140000 13221422450001 13221426660001 13221427510001 13221427940014 13221428340001 13221430860001 13221435480001 13221439240005 13221439690001 13221440200011 13221443490001 13221456040001 13221456450001 13221472850001 13225742840001 13225759250001 13225767640001 13225768010003 13226648440001 13226648800001 13226649170002 13226652660001 13227462040001 13227462380001 13227470780001 13236970260001 13236974460001 13236974870001 13236975260003 13236978680003 13239444610003 13239448810007 13239457220001 13239457600001 13239457940001 13239465950003 13239469840001 13239470470001 13239659150001 13239659470001 13239663010001 13239663340001 13239663660001 13239663980001 13239671420001 13239675610001 13239679820003 13239680120001 13239680690001 13239684010006 13239684300001 13239684720001 13245581560003 13245581900009 13245585010001 13245586010001 13245589530001 13245589860001 13245590190000 13245593410001 13245610210001 13245614410001 13245614770001 13255017620001 13255944610005 13255945010002 13255945380001 13255945760001 13257676820005 13257677220001 13257678230001 13257678700001 13257693620001 13258372820001 13258419010003 13261132820001 13269638420003 13269642670005 13269651070003 13269651560003 13269652400001 13269659930001 13269660290001 13269668160003 13269672020001 13269673450003 13269681250001 13269681600003 13269682320001 13269682670001 13269683020001 13269683390001 13269693020007 13269694700001 13269695110001 13269695480001 13269695850001 13269696230001 13269735020003 13270468820005 13270565420004 13281046840005 13281047540001 13281048090001 13281051460001 13287744620004 13287926610002 13287929410003 13287930350003 13287930680001 13287930790001 13287930850003 13287933620001 13287934120001 13287934570005 13287935010001 13287963020015 13287964280001 13287972630003 13287973760003 13287974790001 13287975300011 13287975820001 13287984020001 13287986060001 13287987410001 13287988770001 13287990210001 13287990830001 13287991440001 13287992050001 13287992660003 13287993290007 13287996620007 13287997320001 13287998050003 13287999240001 13287999830001 13294908610001 13294917020001 13294917640001 13297299020003 13297299690003 13297311620001 13297312240001 13297328960002 13297332630001 13297333430001 13297334060003 13297334750001 13297345230003 13297353620001 13297354290001 13297355010001 13297355600001 13298255420003 13298268010005 13299169810001 13299169860003 13300860010001 13300864210001 13300864280011 13300864310001 13300868410005 13306790430001 13306790450001 13306790460007 13306790480001 13306798830001 13306798870005 13306798940003 13311198620001 13311198630011 13311236440001 13322556610001 13322565020003 13322569220001 13322569230009 13322569240011 13322569250019 13322569260017 13322573410001 13322573430007 13322573440011 13322573450011 13322577620001 13322577630007 13322577640013 13323370220009 13323370240009 13323370250011 13323370260013 13323399620001 13323399640007 13323454230001 13323458440001 13323466840001 13323471030005 13327671030001 13327671040011 13327671060001 13327671120001 13327675230001 13327675250001 13327675260001 13327675280001 13327683680001 13327687830001 13336315230003 13336315240015 13336319430001 13336319460002 13336319480001 13336319490007 13336319500011 13336319520001 13336319530010 13336323630001 13336327830001 13349161850001 13349195430001 13349195520000 13349199630001 13349199650001 13349199670001 13349199700001 13349199720003 13349199730007 13349199740011 13349203830001 13349203910001 13349204010001 13349204030001 13349204040011 13349204050014 13349204070001 13349204080011 13351770630003 13351770650007 13351770680007 13351770690011 13351770710007 13351770720011 13351770740001 13351770750011 13351770770001 13351770790007 13351770800011 13351770810015 13351770830001 13351770860001 13351770870005 13351770880013 13351770890015 13351770910005 13351770920015 13351770940001 13351770950007 13351770960005 13351774830001 13351774880001 13351774910008 13351774950001 13351775010001 13351775020009 13351775030011 13351775050001 13351775060005 13351775070007 13351775090011 13351775100016 13351775110017 13351775130002 13351775140007 13351775150007 13351775220026 13351775270011 13351779030001 13351779070001 13351779090007 13351779100011 13351779110017 13351779130001 13351779140007 13351779150011 13351779160011 13351779170011 13351779180016 13351795830001 13351796010001 13351796030001 13351796040007 13351796050011 13351796070001 13351796080007 13351796090011 13351800030001 13351800070001 13351800080007 13352571630001 13352571650001 13352571660011 13352727030001 13353439850007 13353439860015 13353439870015 13355272840001 13355272850007 13355281240003 13359588630001 13359588830001 13363946460001 13363946480009 13363950650011 13363954830001 13363954860001 13363959080003 13363959100001 13364802030001 13364802050007 13364814630001 13375866090001 13375866130001 13375866140007 13375874470001 13375878640001 13375878650016 13376017240005 13376017260007 13376021440001 13376025660015 13376038240001 13376067640001 13376071830001 13376097040001 13376126460001 13376126490001 13376126510002 13376143250001 13376835040009 13376843440001 13376847640001 13376877040007 13376906440003 13376910640001 13376910660001 13376910670013 13376919040003 13376923240003 13376927440005 13377715850001 13378579860003 13378580280001 13378584070003 13383784840003 13383784860001 13383784870006 13383793280007 13383814250001 13383814280001 13383818450001 13388989910001 13389883250001 13389883260011 13397663450009 13397664580001 13397667650003 13400264600001 13400265220001 13400265810005 13400266370001 13401086620007 13401098510017 13401099090001 13406244650001 13406245720009 13406254210001 13406261460013 13406262490001 13406263410001 13406270590001 13406273380001 13406275350001 13406283670003 13406284020001 13406286650003 13406287290003 13406287750007 13406288080001 13406288090015 13406288110001 13418221080001 13418224370007 13418248290001 13418251060013 13418253070001 13418253700002 13418254980001 13418255610001 13418256900005 13418258290001 13418258990001 13418260270001 13418260860001 13418261420003 13418261980005 13418262570003 13418263220001 13418298760003 13418299480001 13418300180001 13418300950001 13418302260001 13439118620001 13439118640001 13439923830001 13439932220007 13442427620005 13442427640001 13442427710007 13442431820001 13442431830011 13442431840012 13442431850017 13442431870003 13442431880007 13442431890009 13442431900005 13442431910007 13442431920005 13442431930005 13442431940011 13442431950013 13442432080011 13442436020001 13442436030001 13442436030019 13442436040017 13442436050023 13442436080007 13442436090005 13442436100009 13442436110005 13442436120006 13442440230003 13442440270002 13442440280016 13442440300007 13442440320005 13442440350000 13442440370009 13442440400013 13442440410020 13442440450005 13442440480001 13442440510000 13442440530001 13442444420002 13442444430011 13443312630007 13444176620001 13286139260007 13287858010005 13297534220003 13310435420001 13321659020001 13328358730011 13330116030001 13343210430001 13351732870001 13351968030001 13370057440001 13379448050003 13388042080013 13395005200004 13406202640001 13408799630001 13415707540001 13415878900001 13415887300003 13415895670001 13415908260001 13424497820001 13430512230007 13494402040001 13444327820001 13445103640005 13448563820001 13449331240000 13449524420001 13451126410001 13451126430001 13451982020001 13451990410001 13451994620001 13451994630007 13451994640011 13454645430001 13454645440011 13458004810001 13458004830003 13458093010001 13458093030007 13458097220001 13458097230011 13458130820001 13458130830011 13460458210001 13460458220017 13460458240002 13460458250006 13460458260007 13460458270007 13460458300015 13460458310011 13460462410007 13460462420018 13460462440008 13460563230009 13460743810001 13461490210005 13461490230007 13462371010001 13462371030001 13462371040011 13463939430001 13466523020001 13466523040001 13468540820001 13470012610009 13470012630004 13470054610001 13472659210003 13472659230002 13472663410001 13472747450001 13472747460011 13474467020001 13474467030011 13474467040017 13474467060009 13475360420009 13475381420005 13475381430015 13475431820001 13479638420003 13479739220003 13479739230011 13479739240011 13479739250021 13479739270004 13480405820003 13484931620001 13484935820001 13484935830011 13484935840011 13484935860001 13485631820001 13485631830011 13485825010001 13486403430001 13486432830001 13486474850001 13490849430003 13490849440017 13490853630002 13490853640003 13490853650009 13490887220001 13490887230011 13491730220001 13491789020001 13491789040001 13498528830007 13498680030001 13498684220001 13498684240001 13498684250007 13498684260011 13498684270011 13498684280013 13498684300001 13499628030003 13499632220011 13499644820001 13502949680003 13502974830001 13503037820012 13504585250001 13505487030015 13505499620001 13509752440001 13509781880003 13509836430001 13516730800001 13522885060001 13522885080001 13524392410001 13524668990001 13527903710003 13528012780015 13528972820003 13528972840007 13528972870001 13528972880017 13528977010007 13528977030010 13528981210009 13528981230001 13528981240011 13528985410001 13528985430011 13528989610001 13528989630004 13529685620003 13529715050017 13529794820001 13529828410010 13529828430007 13529828450007 13529828460011 13529828480001 13529828490011 13529828510001 13529828520011 13529828540001 13529828550007 13529828570001 13529828580007 13530692420001 13533250810001 13533309620003 13533988830001 13534093810001 13534152610001 13534152630001 13534152640010 13534156810003 13534156840009 13534161010007 13534161030009 13534161040013 13534161060001 13534161070013 13534161090019 13534161100017 13534161120009 13534161130023 13534161150007 13534165210007 13534165230002 13534165240015 13534165250019 13534165290005 13534165300017 13534165330009 13534165350005 13534165360010 13534165370007 13534165380011 13534882210001 13535041810015 13535775620005 13535775630013 13535775650001 13535779820005 13535779840001 13535779850011 13535779870005 13535779880036 13535779900010 13535779910025 13535868020001 13535868030012 13535901610015 13536618620001 13536723610005 13536744610003 13536744630001 13536744640007 13540011620001 13541026830001 13541026850007 13541026860001 13541026870007 13541026880011 13541026890009 13541026900013 13541844620003 13545443410001 13546303210003 13546303230001 13546303300001 13546932010001 13547158810007 13547158830009 13547158840015 13547158850019 13547158870009 13547158880007 13547158890011 13547158900011 13547158910017 13547158920023 13547158930019 13547158950007 13547972410007 13547972430007 13548723010001 13552292410007 13552292430004 13552292440013 13552292450015 13552292470004 13552351230011 13553152210001 13553156420001 13553894410001 13554012010001 13554083410001 13554918010001 13557379810003 13557489020001 13559942410007 13559942430001 13559942440015 13571317210001 13575574230007 13575574240018 13578967210001 13579013420001 13579013440001 13581576010001 13581580210001 13581605420001 13581756640001 13582498820011 13582498840016 13583409010001 13584100810001 13587582040015 13587624010001 13587687010001 13587687030001 13589364610001 13589486420009 13591126210003 13591126240009 13593810610005 13593810620011 13593831610003 13595400010004 13595450410001 13595484010001 13599833410001 13600575620001 13600575630011 13600701610001 13600718450007 13601544630001 13601586610001 13601586620014 13602349820001 13602354010009 13603092020003 13603163410001 13603192830015 13603247410001 13603348220001 13605843610001 13607512820001 13607638830007 13609383610001 13612722020001 13612831210011 13612835410005 13614366030001 13614475250001 13614479420001 13614479440001 13614479450009 13614479460011 13615288820001 13617964810007 13617969010003 13618707020003 13618782620002 13619659220001 13624080020001 13629964220005 13630719040001 13630803030001 13630807210003 13630807230002 13630807240005 13630807250005 13630807260004 13630807270009 13630807280011 13631034030011 13631692210001 13632568810005 13636104610001 13636104620005 13636817410001 13637706610001 13637706620003 13638604210003 13638696610001 13639539620001 13639539630005 13642827610005 13642840210006 13643075410001 13644673210015 13649074810002 13649922030001 13650630610001 13651620610001 13651620630003 13651620640009 13654204210001 13655022030001 13660096810001 13660923090001 13661959220001 13669689010007 13678371020005 13678379420011 13678476010003 13684574410001 13687074010001 13693885210005 13703540410003 13705129820001 13708711810001 13714717820015 13715481050004 13721482820001 13723244410001 13745050240017 13757670030001 13757922020001 13769124630001 13770651020001 13776728420007 13782898230001 13679319010002 13630878640004 13698255620001 13727614840001 13615444220001 13667982010001 13714726210001 13650731420005 13705171820011 13534035020001 13615444230011 13618837270005 13619512230007 13527257890001 13631893820001 13651494620005 13692035420001 13667260830007 13716265210001 13716286220011 13699803050001 13733717410001 13426175420001 13516135870007 13528859420000 13529740210028 13539433230001 13624872620003 13631641820001 13637010640005 13637014810005 13637014820007 13637870410001 13637904010001 13642110610001 13656817210005 13667109620001 13679323220001 13684288820001 13684545010001 13685987450001 13705171810001 13709353220001 13711224010001 13718039420003 13723416610001 13723420830007 13723425010001 13726872630001 13775172610001










)]});
   foreach my $rec ($wf->getHashList(qw(ALL))){
      msg(INFO,"msg=".Dumper($rec));
      $op->CleanupWorkspace($rec->{id});
      $op->ValidatedUpdateRecord($rec,{eventend=>NowStamp("en"),
                                       closedate=>NowStamp("en"),
                                       stateid=>21,
                                       fwdtarget=>undef,
                                       step=>'base::workflow::request::finish',
                                       fwdtargetid=>undef
                                       },{id=>\$rec->{id}});
   }



   return({exitcode=>0});
}

sub SampleEvent1
{
   my $self=shift;
   my $p=$self;

   msg(INFO,"Start(Event1): ... sleep no");
   my $now=NowStamp("en");
   msg(DEBUG,"DATE now=".$now);
   msg(DEBUG,"DATE ExpandTimeExpression (default)=".
             $p->ExpandTimeExpression($now));
   msg(DEBUG,"DATE ExpandTimeExpression (CET)=".
             $p->ExpandTimeExpression($now,undef,"GMT","CET"));
   msg(DEBUG,"DATE ExpandTimeExpression (CET,de)=".
             $p->ExpandTimeExpression($now,"de","GMT","CET"));
   msg(DEBUG,"DATE ExpandTimeExpression (CET,RFC822)=".
             $p->ExpandTimeExpression($now,"RFC822","GMT","CET"));
   msg(DEBUG,"DATE ExpandTimeExpression (UTC,RFC822)=".
             $p->ExpandTimeExpression($now,"RFC822","GMT","UTC"));
   msg(DEBUG,"DATE ExpandTimeExpression (CET,stamp)=".
             $p->ExpandTimeExpression($now,"stamp","GMT","CET"));
   kill(10,$$);




   msg(DEBUG,"End  (Event1):");
   return({msg=>'heinz',exitcode=>0});
}


sub wftest
{
   my $self=shift;

   eval("use Time::HiRes qw( usleep time clock);");
   foreach my  $mod (qw(base::user base::grp base::workflow)){
      my $st=Time::HiRes::time();
      msg(DEBUG,"Start(wftest\@$mod): %lf",$st);
      my $o=getModuleObject($self->Config,$mod);
      if (defined($o)){
         my $en=Time::HiRes::time();
         my $t=$en-$st;
         msg(DEBUG,"End(wftest\@$mod):%lf   = op:%lf",$en,$t);
      }
   }


   return({exitcode=>0});
}


sub memtest
{
   my $self=shift;

   msg(DEBUG,"Start(memtest):");
   eval("use GTop;"); 
   msg(DEBUG,"W5V2::Cache=%s\n",join(",",keys(%{$W5V2::Cache->{w5base2}})));
   msg(DEBUG,"W5V2::Context=%s\n",join(",",keys(%{$W5V2::Context})));
   my $g0=GTop->new->proc_mem($$);
   for(my $cc=0;$cc<50;$cc++){ 
      my $g1=GTop->new->proc_mem($$);
      for(my $c=0;$c<10000;$c++){ 
         my $e=NowStamp("en");
      }
      my $g=GTop->new->proc_mem($$);
      msg(DEBUG,"loop=%02d mem=".$g->vsize." total=%d loopdelta=%d\n",$cc,$g-$g0,$g-$g1);
   }
   msg(DEBUG,"End  (memtest):");
   msg(DEBUG,"W5V2::Context=%s\n",join(",",keys(%{$W5V2::Context})));
   msg(DEBUG,"W5V2::Cache=%s\n",join(",",keys(%{$W5V2::Cache->{w5base2}})));
   return({exitcode=>0});
}


sub SampleEvent2
{
   my $self=shift;

   my $user=getModuleObject($self->Config,"tsacinv::system");
   msg(DEBUG,"user=$user");
   msg(DEBUG,"Start(Event2):");
   my $n=$user->CountRecords();
   msg(DEBUG,"End(Event2): n=$n");
   return({exitcode=>-1});
}

sub wiwTest
{
   my $self=shift;

   my $st=Time::HiRes::time();
   msg(DEBUG,"Start(wiwTest): %lf",$st);
   my $user=getModuleObject($self->Config,"tswiw::user");
   msg(DEBUG,"ModuleFound(wiwTest) \@ sec %lf",Time::HiRes::time()-$st);
   $user->SetFilter({surname=>'Vog*',givenname=>'*mut'});
   msg(DEBUG,"CountStart(wiwTest) \@ sec %lf",Time::HiRes::time()-$st);
   my $n=$user->CountRecords();
   msg(DEBUG,"End(wiwTest) \@ sec %lf",Time::HiRes::time()-$st);
   return({exitcode=>0});
}

sub SampleEvent3
{
   my $self=shift;
   my $sec=shift;
   my $this="SampleEvent3";
   $sec=3 if (!defined($sec));

   msg(DEBUG,"Start(Event3) config=%s",$self->Config);
   for(my $c=0;$c<$sec;$c++){
      msg(DEBUG,"Wait(Event3): ... sleep 1");sleep(1);
      $self->ipcStore("working at $c");
   }
   msg(DEBUG,"End  (Event3): self=$self ipc=$self->{ipc}");
   return({result=>"jo"});
}

sub loadsys
{
   my $self=shift;
   my $name=shift;
   my $res={};

   my $sys=getModuleObject($self->Config,"itil::system");
   if (!$sys->Ping()){
      return({msg=>'ping failed to dataobject '.$sys->Self(),exitcode=>1});
   }



   $sys->SetFilter({name=>$name});
   my @l=$sys->getHashList(qw(systemid assetassetid systemname));
printf STDERR ("res=%s\n",Dumper(\@l));
   $res=$l[0]->{assetassetid};


   return($res); 
}





1;
